<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>
<body>
    <button class="eyesChanger">Change Eyes</button>
    <button class="smileChanger">Smile</button>
    <h2 class="distance"></h2>
    <div class="cat">
            <!-- stroke:#000000;stroke-miterlimit:10; -->
            <?xml version="1.0" encoding="utf-8"?>
            <!-- Generator: Adobe Illustrator 22.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
            <svg class="kitten" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 viewBox="0 0 1280 1024" style="enable-background:new 0 0 1280 1024;" xml:space="preserve">
            <style type="text/css">
                .st0{fill:#2EC7FF;}
                .st1{fill:#5CD3FF;}
                .st2{fill:#2EB5FF;}
                .st3{fill:#299ACC;}
                .st4{fill:#196FA3;}
                .st5{fill:#ffcccb;}
                .st6{fill:#FFFFFF;}
                .st7{fill:#FFFFFF;}
                .st8{fill:#46D3F9;}
                .st9{fill:#2EB5FF;}
                .st10{fill:#6BCEF9;}
                .st11{stroke:#000000;stroke-miterlimit:10;}
            </style>
            <g id="Head">
                <polygon class="st0" points="534,174 740,174 854,242 854,329 704,443 603,443 430,329 430,242 	"/>
            </g>
            <g id="UpperBpdy">
                <g>
                    <polygon class="st1" points="543.6,534.9 603.3,443.5 703.7,443.5 751.4,534.9 651,635.3 		"/>
                    <!-- <path d="M703.4,444l47.4,90.8L651,634.6l-106.7-99.8l59.2-90.8H703.4 M704,443H603l-60,92l108,101l101-101L704,443L704,443z"/> -->
                </g>
            </g>
            <g id="Body">
                <polygon class="st2" points="542.5,534.5 494.5,591.5 622.5,972.5 672.5,972.5 812.5,591.5 751.5,534.5 650.5,636.5 	"/>
            </g>
            <g id="LeftLeg">
                <polygon class="st3" points="547,749 472,891 520,973 622,972 	"/>
            </g>
            <g id="RightLeg">
                <polygon class="st3" points="754.5,748.5 829.5,890.5 770.5,972.5 672.5,972.5 	"/>
            </g>
            <g id="Tail">
                <g>
                    <polygon class="st1" points="781.2,798 872.4,758 800.3,834.1 		"/>
                    <!-- <path d="M870.4,759.4l-70,73.8l-18.5-35L870.4,759.4 M874.5,756.5l-94,41.2l19.6,37.2L874.5,756.5L874.5,756.5z"/> -->
                </g>
            </g>
            <g id="Nose">
                <polygon class="st4" points="617.5,328.5 676.5,328.5 647.5,351.5 	"/>
            </g>
            <g id="InsideMouth">
                <polygon class="st5" points="647,351 701,311 767.2,395 704,443 603,443 513,383.7 593,311 	"/>
            </g>
            <g id="EyeWhiteRight">
                <g>
                    <polygon class="st6" points="716,328.5 701.6,310.9 714.8,278.5 763.1,278.5 780.3,300 753.8,328.5 		"/>
                    <!-- <path d="M762.9,279l16.8,21l-26.1,28h-37.3l-14.1-17.2l13-31.8H762.9 M763.3,278h-48.8L701,311l14.7,18H754l27-29L763.3,278
                        L763.3,278z"/> -->
                </g>
            </g>
            <g id="EyeWhiteLeft">
                <polygon class="st7" points="592.5,310.5 576.2,277.5 521.4,277.5 508,299.5 535.8,328.5 574,329 	"/>
            </g>
            <g id="MouthDownOpen">
                <ellipse id="Toungue" class="st4" cx="647" cy="413.5" rx="19" ry="11.5"/>
                <polygon id="Jaw" class="st8" points="548,350 607,411.7 688,411.7 737,355.1 767,394.5 704,443 603,443 513,383.4 	"/>
                <g id="TeethLeft">
                    <polygon class="st6" points="602.4,391.5 607,408 612.2,392 		"/>
                </g>
                <g id="TeethRight">
                    <polygon class="st6" points="682.4,390.5 687,407 692.2,391 		"/>
                </g>
            </g>
            <g id="MouthDownCLosed">
                <polyline id="JawClosed" class="st8" points="548,350 607,394.5 647,372.2 687,394.5 737,355.1 767,394.5 704,443 602,443 
                    513,383.4 548,350 548,350 	"/>
            </g>
            <g id="MouthUp">
                <polygon class="st9" points="548,350 607,395 647,372 687,395 737.1,355.8 701,310 647,350 592,310 	"/>
            </g>
            <g id="RightEar">
                <polygon id="RightEarOuter" class="st10" points="740.5,174.5 854.5,0.5 854.5,242.5 	"/>
                <polygon id="RightEarInner" class="st4" points="761.3,186.9 829.5,68.5 829.5,227.4 	"/>
            </g>
            <g id="LeftEar">
                <polygon id="LeftEarOuter" class="st10" points="430.5,0.5 430.5,241.5 533.5,173.5 	"/>
                <polygon id="LeftEarInner" class="st4" points="513,187 452.5,68.5 451.9,227.4 	"/>
            </g>
            <g id="Shadow">
                <polygon id="ShadowPath" class="st4" points="603.6,443 704.3,443.6 709,452.5 697.5,455.5 606.5,455.5 597,452.1 	"/>
            </g>
            <g id="MedEyes">
                <path id="MedEyeRight" class="st11" d="M737.5,277.5c0,0-27,24,0,51C737.5,328.5,764.5,304.5,737.5,277.5z"/>
                <path id="MedEyeLeft" class="st11" d="M556.5,277.5c0,0-27,24,0,51C556.5,328.5,583.5,304.5,556.5,277.5z"/>
            </g>
            <g id="BigEyes">
                <!-- <circle id="BigEyeRight" class="st11" cx="736.5" cy="303.5" r="25"/> -->
                <path id="BigEyeRight" class="st11" d="M711.5,303.5a25,25 0 1,0 50,0a25,25 0 1,0 -50,0"/>
                <!-- <circle id="BigEyeLeft" class="st11" cx="555" cy="303" r="25.5"/> -->
                <path id="BigEyeLeft" class="st11" d="M530,303a25,25 0 1,0 50,0a25,25 0 1,0 -50,0"/>
                <g id="Glare">
                    <path id="GlareRight" class="st6" d="M743,290a6,6 0 1,0 12,0a6,6 0 1,0 -12,0" />
                    <path id="GlareLeft" class="st6" d="M563,290a6,6 0 1,0 12,0a6,6 0 1,0 -12,0"/>
                </g>
                <!-- <g id="GlareRight">
                    <circle class="st6" cx="749" cy="290" r="6"/>
                    
                    <path class="st6" d="M749,284.5c3,0,5.5,2.5,5.5,5.5s-2.5,5.5-5.5,5.5s-5.5-2.5-5.5-5.5S746,284.5,749,284.5 M749,283.5
                        c-3.6,0-6.5,2.9-6.5,6.5s2.9,6.5,6.5,6.5s6.5-2.9,6.5-6.5S752.6,283.5,749,283.5L749,283.5z"/>
                </g>
                <g id="GlareLeft">
                    <circle class="st6" cx="569" cy="290" r="6"/>
                    
                    <path d="M569,284.5c3,0,5.5,2.5,5.5,5.5s-2.5,5.5-5.5,5.5s-5.5-2.5-5.5-5.5S566,284.5,569,284.5 M569,283.5
                        c-3.6,0-6.5,2.9-6.5,6.5s2.9,6.5,6.5,6.5s6.5-2.9,6.5-6.5S572.6,283.5,569,283.5L569,283.5z"/>
                </g> -->
            </g>

            <g id="SmallEye">
                <path id="SmallEyeRight" class="st11" d="M737.1,278c0,0-14.4,17.5,0,50.5C737.1,328.5,748.7,299.5,737.1,278z"/>
                <path id="SmallEyeLeft" class="st11" d="M557.1,278c0,0-14.4,17.5,0,50.5C557.1,328.5,568.7,299.5,557.1,278z"/>
            </g>
            </svg>            
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.1/gsap.min.js"></script>
    <script src="https://unpkg.com/flubber@0.3.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/snap.svg/0.5.1/snap.svg-min.js" integrity="sha512-Gk+uNk8NWN235mIkS6B7/424TsDuPDaoAsUekJCKTWLKP6wlaPv+PBGfO7dbvZeibVPGW+mYidz0vL0XaWwz4w==" crossorigin="anonymous"></script>
    <script>
        var polys = document.querySelectorAll('polygon,polyline');
[].forEach.call(polys,convertPolyToPath);

function convertPolyToPath(poly){
  var svgNS = poly.ownerSVGElement.namespaceURI;
  var path = document.createElementNS(svgNS,'path');
  var pathdata = 'M '+poly.getAttribute('points');
  if (poly.tagName=='polygon') pathdata+='z';
  path.setAttribute('d',pathdata);
  path.setAttribute('class', poly.getAttribute('class'));
  path.setAttribute('id', poly.getAttribute('id'));
  poly.parentNode.replaceChild(path,poly);
}
        var cat = document.querySelector(".cat");
        var eyeButton = document.querySelector(".eyesChanger");
        var smileButton = document.querySelector(".smileChanger");
        var head = document.querySelector("#Head");
        var smallEyeLeft = document.querySelector("#SmallEyeLeft");
        var smallEyeRight = document.querySelector("#SmallEyeRight");
        var medEyeRight = document.querySelector("#MedEyeRight");
        var medEyeLeft = document.querySelector("#MedEyeLeft");
        var bigEyeRight = document.querySelector("#BigEyeRight");
        var bigEyeLeft = document.querySelector("#BigEyeLeft");
        var jawClosed = document.querySelector("#JawClosed");
        var jaw = document.querySelector("#Jaw");
        var eyeState = "small"; 
        var smileSate = "no";
        var s = Snap(document.querySelector(".cat"));
        var jawClosedSnap = Snap.select("#JawClosed");
        var jawSnap = Snap.select("#Jaw");

        function getPosition(el) {
  var xPos = 0;
  var yPos = 0;
 
  while (el) {
    if (el.tagName == "BODY") {
      // deal with browser quirks with body/window/document and page scroll
      var xScroll = el.scrollLeft || document.documentElement.scrollLeft;
      var yScroll = el.scrollTop || document.documentElement.scrollTop;
 
      xPos += (el.offsetLeft - xScroll + el.clientLeft);
      yPos += (el.offsetTop - yScroll + el.clientTop);
    } else {
      // for all other non-BODY elements
      xPos += (el.offsetLeft - el.scrollLeft + el.clientLeft);
      yPos += (el.offsetTop - el.scrollTop + el.clientTop);
    }
 
    el = el.offsetParent;
  }
  return {
    x: xPos,
    y: yPos
  };
}

        function animateMouth(source, target) {
            let interpolator = flubber.interpolate(source.getAttribute("d"), target.getAttribute("d"));
            var obj = {t: 0};
            gsap.to(obj, {
                duration: 0.5,
                ease: Expo.easeOut,
                t: 1,
                onUpdate: function() {
                    source.setAttribute("d", interpolator(obj.t));
                }
            })
            
        }

        function animateEyes(sourceRight, targetRight, sourceLeft, targetLeft) {
            let interpolatorRight = flubber.interpolate(sourceRight.getAttribute("d"), targetRight.getAttribute("d"));
            let interpolatorLeft = flubber.interpolate(sourceLeft.getAttribute("d"), targetLeft.getAttribute("d")); 
            var obj = {t: 0};
            gsap.to(obj, {
                duration: 0.3,
                ease: Expo.easeOut,
                t: 1,
                onUpdate: function() {
                    sourceLeft.setAttribute("d", interpolatorLeft(obj.t));
                    sourceRight.setAttribute("d", interpolatorRight(obj.t));
                }
            })
        }

        function calculateDistance(elem, x, y, mouseX, mouseY) {
            return Math.floor(Math.sqrt(Math.pow(mouseX - (x+(elem.clientWidth/2)), 2) + Math.pow(mouseY - (y+(elem.clientHeight/2)), 2)));
        }
        eyeButton.addEventListener("click", animateEyes);
        smileButton.addEventListener("click", animateMouth);
        document.querySelector(".cat").addEventListener("mousemove", function(e) {
            mX = e.pageX;
            mY = e.pageY;
            var pos = getPosition(cat);
            var distance = calculateDistance(cat, pos.x, pos.y, mX, mY);
            if(distance <= 250 && distance > 175) {
                // animateMouth(jaw, jawClosed);
                animateEyes(smallEyeRight, medEyeRight, smallEyeLeft, medEyeLeft);
                eyeState = "med";
            } else if (distance <= 175){
                animateMouth(jawClosed, jaw);
                animateEyes(smallEyeRight, bigEyeRight, smallEyeLeft, bigEyeLeft);
                eyeState="big";
            }
            document.querySelector(".distance").textContent = distance;

        })
    </script>
</body>
</html>